language: C

install: make

services:
  - docker

before_install:
  - docker logout
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USERNAME --p $DOCKER_PASSWORD

stages:
  - build
  - name: push
    if: branch = master

jobs:
  include:
    - stage: build
      script: make build
    - stage: push
      script: make push